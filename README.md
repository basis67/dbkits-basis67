# Basis67 DBKits - æ•°æ®åº“è„šæ‰‹æ¶å·¥ç¨‹

## é¡¹ç›®ç®€ä»‹

Basis67 DBKits æ˜¯ä¸€ä¸ªåŸºäºJava SpringBootæŠ€æœ¯æ ˆçš„å¿«é€Ÿå¼€å‘è„šæ‰‹æ¶ï¼Œæä¾›ï¼š

* ğŸ“¦ å¤šæ•°æ®åº“æ”¯æŒï¼ˆMySQL + MongoDBï¼‰
* ğŸ› ï¸ æ ‡å‡†åŒ–RESTful APIå¼€å‘æ¨¡æ¿
* ğŸ“‘ è‡ªåŠ¨ç”ŸæˆSwagger APIæ–‡æ¡£
* ğŸ”§ MyBatisæŒä¹…å±‚é›†æˆ
* ğŸš€ å¿«é€Ÿæ­å»ºå¯ä¼¸ç¼©çš„æ•°æ®æœåŠ¡å±‚
* ğŸ­ å¯å®šåˆ¶çš„ä»£ç ç”Ÿæˆå™¨ï¼ˆåŸºäºFreeMarkeræ¨¡æ¿å¼•æ“ï¼‰

## æŠ€æœ¯æ ˆ

| ç±»å‹       | æŠ€æœ¯ç»„ä»¶                        |
| -------- | --------------------------- |
| æ ¸å¿ƒæ¡†æ¶     | Spring Boot 3.4.3           |
| æŒä¹…å±‚      | MyBatis 3.0.4 / Spring Data |
| å…³ç³»å‹æ•°æ®åº“   | MySQL 8.0+ / MariaDB 10.0+  |
| NoSQLæ•°æ®åº“ | MongoDB 8.0+                |
| APIæ–‡æ¡£    | Swagger UI 3.0              |
| æ„å»ºå·¥å…·     | Maven 3.8+                  |
| æµ‹è¯•æ¡†æ¶     | JUnit 5 + Mockito           |
| æ¨¡æ¿å¼•æ“     | FreeMarker 2.3.34           |

## é¡¹ç›®ç»“æ„

```text
deploy/                   # éƒ¨ç½²ç›¸å…³ç›®å½•
â”œâ”€â”€ config/               # é…ç½®æ–‡ä»¶ç›®å½•
â”œâ”€â”€ docker/               # Dockerç›¸å…³æ–‡ä»¶ç›®å½•
â””â”€â”€ sql/                  # SQLè„šæœ¬ç›®å½•

module-common/            # é€šç”¨æ¨¡å—
â””â”€â”€ src/                  # æºä»£ç ç›®å½•
    â”œâ”€â”€ main/             # ä¸»ä»£ç ç›®å½•
    â”‚   â”œâ”€â”€ java/         # Javaæºä»£ç æ ¹ç›®å½•
    â”‚   â”‚   â””â”€â”€ com/basis67/dbkits/common/ # é€šç”¨æ¨¡å—åŒ…è·¯å¾„
    â”‚   â”‚       â”œâ”€â”€ dto/  # æ•°æ®ä¼ è¾“å¯¹è±¡ï¼ˆé€šç”¨æ•°æ®ä¼ è¾“è½½ä½“ï¼‰
    â”‚   â”‚       â””â”€â”€ model/ # æ•°æ®æ¨¡å‹å±‚ï¼ˆé€šç”¨æ•°æ®æ¨¡å‹ï¼‰
    â”‚   â””â”€â”€ resources/    # èµ„æºæ–‡ä»¶ç›®å½•
    â””â”€â”€ test/             # æµ‹è¯•ä»£ç ç›®å½•
        â””â”€â”€ java/         # æµ‹è¯•Javaä»£ç ç›®å½•

module-generator/         # ä»£ç ç”Ÿæˆæ¨¡å—
â””â”€â”€ src/                  # æºä»£ç ç›®å½•
    â””â”€â”€ main/             # ä¸»ä»£ç ç›®å½•
        â”œâ”€â”€ java/         # Javaæºä»£ç æ ¹ç›®å½•
        â”‚   â””â”€â”€ com/basis67/dbkits/generator/ # ä»£ç ç”Ÿæˆæ¨¡å—åŒ…è·¯å¾„
        â”‚       â”œâ”€â”€ controllers/ # APIæ§åˆ¶å™¨å±‚ï¼ˆå¤„ç†HTTPè¯·æ±‚ï¼Œä»£ç ç”Ÿæˆç›¸å…³ï¼‰
        â”‚       â”œâ”€â”€ dto/         # æ•°æ®ä¼ è¾“å¯¹è±¡ï¼ˆä»£ç ç”Ÿæˆæ•°æ®ä¼ è¾“è½½ä½“ï¼‰
        â”‚       â”œâ”€â”€ exception/   # è‡ªå®šä¹‰å¼‚å¸¸å¤„ç†ï¼ˆä»£ç ç”Ÿæˆå¼‚å¸¸ç®¡ç†ï¼‰
        â”‚       â”œâ”€â”€ model/       # æ•°æ®æ¨¡å‹å±‚ï¼ˆä»£ç ç”Ÿæˆæ•°æ®æ¨¡å‹ï¼‰
        â”‚       â”œâ”€â”€ service/     # ä¸šåŠ¡é€»è¾‘å±‚ï¼ˆä»£ç ç”Ÿæˆæ ¸å¿ƒæœåŠ¡å®ç°ï¼‰
        â”‚       â””â”€â”€ util/        # å·¥å…·ç±»ï¼ˆä»£ç ç”Ÿæˆç›¸å…³å·¥å…·ï¼‰
        â””â”€â”€ resources/    # èµ„æºæ–‡ä»¶ç›®å½•
            â”œâ”€â”€ static/   # é™æ€èµ„æºç›®å½•
            â”œâ”€â”€ templates/ # æ¨¡æ¿æ–‡ä»¶ç›®å½•ï¼ˆä»£ç ç”Ÿæˆæ¨¡æ¿ï¼‰
            â””â”€â”€ application.yml # ä»£ç ç”Ÿæˆå™¨æœåŠ¡é…ç½®æ–‡ä»¶

project-demo/             # é¡¹ç›®æ¼”ç¤ºæ¨¡å—
â””â”€â”€ src/                  # æºä»£ç ç›®å½•
    â”œâ”€â”€ main/             # ä¸»ä»£ç ç›®å½•
    â”‚   â”œâ”€â”€ java/         # Javaæºä»£ç æ ¹ç›®å½•
    â”‚   â”‚   â””â”€â”€ com/basis67/dbkits/ # é¡¹ç›®æ¼”ç¤ºæ¨¡å—åŒ…è·¯å¾„
    â”‚   â”‚       â”œâ”€â”€ controllers/ # APIæ§åˆ¶å™¨å±‚ï¼ˆå¤„ç†HTTPè¯·æ±‚ï¼Œé¡¹ç›®æ¼”ç¤ºç›¸å…³ï¼‰
    â”‚   â”‚       â”œâ”€â”€ dto/         # æ•°æ®ä¼ è¾“å¯¹è±¡ï¼ˆé¡¹ç›®æ¼”ç¤ºæ•°æ®ä¼ è¾“è½½ä½“ï¼‰
    â”‚   â”‚       â”œâ”€â”€ exception/   # è‡ªå®šä¹‰å¼‚å¸¸å¤„ç†ï¼ˆé¡¹ç›®æ¼”ç¤ºå¼‚å¸¸ç®¡ç†ï¼‰
    â”‚   â”‚       â”œâ”€â”€ mapper/      # MyBatisæ˜ å°„æ¥å£ï¼ˆé¡¹ç›®æ¼”ç¤ºæ•°æ®åº“æ“ä½œå£°æ˜ï¼‰
    â”‚   â”‚       â”œâ”€â”€ model/       # æ•°æ®æ¨¡å‹å±‚
    â”‚   â”‚       â”‚   â”œâ”€â”€ mongo/   # MongoDBæ–‡æ¡£æ¨¡å‹ï¼ˆé¡¹ç›®æ¼”ç¤ºNoSQLæ•°æ®å®ä½“ï¼‰
    â”‚   â”‚       â”‚   â””â”€â”€ mysql/   # MySQLå®ä½“æ¨¡å‹ï¼ˆé¡¹ç›®æ¼”ç¤ºå…³ç³»å‹æ•°æ®åº“å®ä½“ï¼‰
    â”‚   â”‚       â”œâ”€â”€ repository/  # æ•°æ®è®¿é—®ä»“åº“æ¥å£ï¼ˆé¡¹ç›®æ¼”ç¤ºæ•°æ®åº“æ“ä½œæŠ½è±¡ï¼‰
    â”‚   â”‚       â””â”€â”€ service/     # ä¸šåŠ¡é€»è¾‘å±‚ï¼ˆé¡¹ç›®æ¼”ç¤ºæ ¸å¿ƒæœåŠ¡å®ç°ï¼‰
    â”‚   â””â”€â”€ resources/          # èµ„æºæ–‡ä»¶ç›®å½•
    â”‚   â”œâ”€â”€ application.yml     # ä¸»é…ç½®æ–‡ä»¶ï¼ˆé¡¹ç›®æ¼”ç¤ºSpring Booté…ç½®ï¼‰
    â”‚   â””â”€â”€ generatorConfig.xml # MyBatis Generatoré…ç½®æ–‡ä»¶ï¼ˆæ•°æ®åº“CRUDä»£ç ç”Ÿæˆé…ç½®ï¼‰
    â””â”€â”€ test/             # æµ‹è¯•ä»£ç ç›®å½•
        â””â”€â”€ java/         # æµ‹è¯•Javaä»£ç ç›®å½•
            â””â”€â”€ com/basis67/dbkits/ # æµ‹è¯•ç±»åŒ…è·¯å¾„ï¼ˆå¯¹åº”é¡¹ç›®æ¼”ç¤ºçš„å•å…ƒæµ‹è¯•ï¼‰
                â”œâ”€â”€ controllers/ # æ§åˆ¶å™¨å±‚å•å…ƒæµ‹è¯•
                â””â”€â”€ service/     # æœåŠ¡å±‚å•å…ƒæµ‹è¯•
```

## å¿«é€Ÿå¯åŠ¨

### 1. å…‹éš†ä»“åº“

```shell
git clone https://github.com/basis67/dbkits-basis67.git
cd dbkits-basis67
```

### 2. é…ç½®ç¯å¢ƒ

- ä¿®æ”¹ `project-demo/src/main/resources/application.yml` ï¼š

```yaml
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/dbkits?useSSL=false
    username: root
    password: your_password
  data:
    mongodb:
      uri: mongodb://localhost:27017/dbkits
```

### 3. å¯åŠ¨æœåŠ¡ï¼ˆé¡¹ç›®æ¼”ç¤ºï¼‰

```shell
cd project-demo
mvn spring-boot:run
```

### 4. è®¿é—®Swagger APIæ–‡æ¡£

æµè§ˆå™¨æ‰“å¼€ï¼š<http://localhost:8080/swagger-ui/>

### 5. ç”Ÿæˆæ•°æ®åº“CRUDä»£ç ï¼ˆé¡¹ç›®æ¼”ç¤ºï¼‰

```shell
cd project-demo
mvn mybatis-generator:generate
```

### 6. å¯åŠ¨â€œä»£ç ç”Ÿæˆå™¨â€æœåŠ¡

```shell
cd module-generator
mvn spring-boot:run
```

### 7. è®¿é—®â€œä»£ç ç”Ÿæˆå™¨â€æœåŠ¡

æµè§ˆå™¨æ‰“å¼€ï¼š<http://localhost:8081/>

![ä»£ç ç”Ÿæˆå™¨æˆªå›¾](screenshot_code_generator.png)

## ä½¿ç”¨ç¤ºä¾‹

### åˆ›å»ºMySQLè®°å½•

**è¯·æ±‚ï¼š**

```bash
curl -v -X POST "http://localhost:8080/api/v1/users" \
-H "Content-Type: application/json" \
-d '{"username":"zhangsan","firstName":"Zhang","lastName":"San","email":"zhangsan@example.com"}'
```

**å“åº”ï¼š**

```text
HTTP/1.1 201 Created
```

### æŸ¥è¯¢MongoDBæ–‡æ¡£

**è¯·æ±‚ï¼š**

```bash
curl "http://localhost:8080/api/v1/logs/action?action=login&start=2025-03-19T08:00:00Z&end=2025-03-19T10:00:00Z"
```

**å“åº”ï¼š**

```json
{
  "code": 200,
  "message": "Success",
  "data": [
      {
        "id": "6417b2d1a1b2c3d4e5f6a7b8",
        "action": "login",
        "userId": "1",
        "details": "user logged in.",
        "timestamp": "2025-03-19T09:55:00Z"
      }
  ]
}

```


## åŠŸèƒ½ç‰¹æ€§

1. **åŒæ•°æ®åº“æ”¯æŒ**ï¼š
	* MySQLå…³ç³»å‹æ•°æ®å­˜å‚¨ï¼ˆä½¿ç”¨MyBatisï¼‰
	* MongoDBæ–‡æ¡£å­˜å‚¨ï¼ˆä½¿ç”¨Spring Dataï¼‰

2. **æ ‡å‡†åŒ–APIè®¾è®¡**ï¼š
	* ç»Ÿä¸€å“åº”æ ¼å¼ï¼ˆHTTPæ ‡å‡†å“åº”ç  + code/message/dataï¼‰
	* åˆ†é¡µæŸ¥è¯¢æ”¯æŒï¼ˆpage/sizeå‚æ•°ï¼‰
	* RESTfulé£æ ¼æ¥å£è®¾è®¡

3. **å¼€å‘æ•ˆç‡æå‡**ï¼š
	* Swagger UIå®æ—¶APIæ–‡æ¡£
	* é€šç”¨DTOå¯¹è±¡è½¬æ¢
	* å¼‚å¸¸ç»Ÿä¸€å¤„ç†æœºåˆ¶

4. **æ‰©å±•æ€§è®¾è®¡**ï¼š
	* æ¨¡å—åŒ–ä»£ç ç»“æ„
	* ä»“åº“æ¨¡å¼æ•°æ®è®¿é—®å±‚
	* é…ç½®åŒ–æ•°æ®åº“è¿æ¥


## æµ‹è¯•è¦†ç›–

* å•å…ƒæµ‹è¯•ï¼šJUnit 5 + Mockito
* é›†æˆæµ‹è¯•ï¼šTestcontainersï¼ˆå¯é€‰ï¼‰
* APIæµ‹è¯•ï¼šSwagger Contract

## è´¡çŒ®æŒ‡å—

1. Forkä»“åº“å¹¶åˆ›å»ºæ–°åˆ†æ”¯

2. æäº¤ä»£ç å‰è¿è¡Œï¼š

    ```bash
    mvn clean test
    ```

3. æäº¤PRæ—¶è¯·éµå¾ª[Conventional Commitsè§„èŒƒ](https://www.conventionalcommits.org/)
